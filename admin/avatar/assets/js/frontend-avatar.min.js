var FrontendAvatar=(FrontendAvatar=function(){return{init:function(){jQuery("#wp_user_profile_avatar_add").on("click",FrontendAvatar.actions.chooseAvatar),jQuery("#wp_user_profile_avatar_remove").on("click",FrontendAvatar.actions.removeAvatar),jQuery("#wp_user_profile_avatar_undo").on("click",FrontendAvatar.actions.undoAvatar),jQuery("#wp_user_profile_avatar_update_profile").on("click",FrontendAvatar.actions.updateAvatar)},actions:{chooseAvatar:function(a){var r;a.preventDefault(),r||(r=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1})).on("select",function(){attachment=r.state().get("selection").first().toJSON(),console.log(attachment),jQuery("#wpupa_attachment_id").attr("value",attachment.id),jQuery("#wp_user_profile_avatar_preview img").attr("src",attachment.sizes.full.url),jQuery("#wp_user_profile_avatar_thumbnail img").attr("src",attachment.sizes.thumbnail.url)}),r.open()},removeAvatar:function(a){jQuery("#upload_avatar_responce").removeClass("wp-user-profile-avatar-error"),jQuery("#upload_avatar_responce").removeClass("wp-user-profile-avatar-success"),jQuery("#upload_avatar_responce").html("");var r=jQuery(".update-user-profile-avatar").serialize(),e=new FormData;e.append("action","remove_user_avatar"),e.append("form_data",r),e.append("security",wp_user_profile_avatar_frontend_avatar.wp_user_profile_avatar_security),jQuery.ajax({url:wp_user_profile_avatar_frontend_avatar.ajax_url,type:"post",dataType:"JSON",data:e,processData:!1,contentType:!1,success:function(a){jQuery("#upload_avatar_responce").addClass(a.class),jQuery("#upload_avatar_responce").html(a.message),"wp-user-profile-avatar-success"==a.class&&(jQuery("#wp_user_profile_avatar_preview img").attr("src",a.avatar_original),jQuery("#wp_user_profile_avatar_thumbnail img").attr("src",a.avatar_thumbnail),jQuery(".update-user-profile-avatar #wpupa_url").val(""),jQuery(".update-user-profile-avatar #wpupa_attachment_id").val(""),jQuery("#wp_user_profile_avatar_remove_button").hide())}})},undoAvatar:function(a){jQuery("#upload_avatar_responce").removeClass("wp-user-profile-avatar-error"),jQuery("#upload_avatar_responce").removeClass("wp-user-profile-avatar-success"),jQuery("#upload_avatar_responce").html("");var r=jQuery(".update-user-profile-avatar").serialize(),e=new FormData;e.append("action","undo_user_avatar"),e.append("form_data",r),e.append("security",wp_user_profile_avatar_frontend_avatar.wp_user_profile_avatar_security),jQuery.ajax({url:wp_user_profile_avatar_frontend_avatar.ajax_url,type:"post",dataType:"JSON",data:e,processData:!1,contentType:!1,success:function(a){jQuery("#upload_avatar_responce").addClass(a.class),jQuery("#upload_avatar_responce").html(a.message),"wp-user-profile-avatar-success"==a.class&&(jQuery("#wp_user_profile_avatar_preview img").attr("src",a.avatar_original),jQuery("#wp_user_profile_avatar_thumbnail img").attr("src",a.avatar_thumbnail),jQuery("#wp_user_profile_avatar_undo_button").hide())}})},updateAvatar:function(a){jQuery("#upload_avatar_responce").removeClass("wp-user-profile-avatar-error"),jQuery("#upload_avatar_responce").removeClass("wp-user-profile-avatar-success"),jQuery("#upload_avatar_responce").html("");var r=jQuery(".update-user-profile-avatar").serialize(),e=new FormData;e.append("user-avatar",jQuery("#wp_user_profile_avatar_add")),e.append("action","update_user_avatar"),e.append("form_data",r),e.append("security",wp_user_profile_avatar_frontend_avatar.wp_user_profile_avatar_security),jQuery.ajax({url:wp_user_profile_avatar_frontend_avatar.ajax_url,type:"post",dataType:"JSON",data:e,processData:!1,contentType:!1,success:function(a){console.log(a),jQuery("#upload_avatar_responce").addClass(a.class),jQuery("#upload_avatar_responce").html(a.message),"wp-user-profile-avatar-success"==a.class&&(jQuery("#wp_user_profile_avatar_preview img").attr("src",a.avatar_original),jQuery("#wp_user_profile_avatar_thumbnail img").attr("src",a.avatar_thumbnail),jQuery("#wp_user_profile_avatar_undo_button").show())}})}}}})();jQuery(document).ready(function(a){FrontendAvatar.init()});